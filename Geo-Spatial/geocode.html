
<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <title>Geocoding - LOST</title>
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/assets/css/just-the-docs.css">
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
  <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Geocoding | LOST</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Geocoding" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Source code for the Library of Statistical Techniques" />
<meta property="og:description" content="Source code for the Library of Statistical Techniques" />
<meta property="og:site_name" content="LOST" />
<script type="application/ld+json">
{"description":"Source code for the Library of Statistical Techniques","@type":"WebPage","headline":"Geocoding","url":"/Geo-Spatial/geocode.html","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="link" viewBox="0 0 16 16">
      <title>Link</title>
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </symbol>
  </svg>
  <div class="page-wrap">
    <div class="side-bar">
      <div class="site-header">
        <a href="" class="site-title lh-tight">
  LOST
</a>
        <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button>
      </div>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list"><li class="navigation-list-item active"><a href="/Geo-Spatial/geocode.html" class="navigation-list-link active">Geocoding</a></li><li class="navigation-list-item"><a href="/" class="navigation-list-link">Home</a></li><li class="navigation-list-item active"><a href="/Data/" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="/Data_Manipulation/data_manipulation.html" class="navigation-list-link">Data Manipulation</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Data_Manipulation/collapse_a_data_set.html" class="navigation-list-link">Collapse a Data Set</a></li><li class="navigation-list-item "><a href="/Data_Manipulation/Combining_Datasets/combining_datasets_overview.html" class="navigation-list-link">Combining Datasets</a><ul class="navigation-list-child-list"><li class="navigation-list-item ">
                            <a href="/Data_Manipulation/Combining_Datasets/combining_datasets_vertical_combination.html" class="navigation-list-link">Vertical Combination</a>
                          </li><li class="navigation-list-item ">
                            <a href="/Data_Manipulation/Combining_Datasets/combining_datasets_horizontal_merge_deterministic.html" class="navigation-list-link">Horizontal Combination (Deterministic)</a>
                          </li></ul></li><li class="navigation-list-item "><a href="/Data_Manipulation/determine_the_observation_level_of_a_data_set.html" class="navigation-list-link">Determine the Observation Level of a Data Set</a></li><li class="navigation-list-item "><a href="/Data_Manipulation/Reshaping/reshape.html" class="navigation-list-link">Reshaping Data</a><ul class="navigation-list-child-list"><li class="navigation-list-item ">
                            <a href="/Data_Manipulation/Reshaping/reshape_panel_data_from_wide_to_long.html" class="navigation-list-link">Reshape Panel Data from Wide to Long</a>
                          </li><li class="navigation-list-item ">
                            <a href="/Data_Manipulation/Reshaping/reshape_panel_data_from_long_to_wide.html" class="navigation-list-link">Reshape Panel Data from Long to Wide</a>
                          </li></ul></li><li class="navigation-list-item "><a href="/Data_Manipulation/rowwise_calculations.html" class="navigation-list-link">Rowwise Calculations</a></li></ul></li><li class="navigation-list-item"><a href="/Geo-Spatial/Summary_Techniques.html" class="navigation-list-link">Geo-Spatial</a><ul class="navigation-list-child-list "></ul></li><li class="navigation-list-item"><a href="/Machine_Learning/Machine_Learning.html" class="navigation-list-link">Machine Learning</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Machine_Learning/causal_forest.html" class="navigation-list-link">Causal Forest</a></li><li class="navigation-list-item "><a href="/Machine_Learning/penalized_regression.html" class="navigation-list-link">Penalized Regression</a></li></ul></li><li class="navigation-list-item"><a href="/Model_Estimation/Estimation.html" class="navigation-list-link">Model Estimation</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Model_Estimation/fixed_effects_in_linear_regression.html" class="navigation-list-link">Fixed Effects in Linear Regression</a></li><li class="navigation-list-item "><a href="/Model_Estimation/heckman_correction_model.html" class="navigation-list-link">Heckman Correction Model</a></li><li class="navigation-list-item "><a href="/Model_Estimation/instrumental_variables.html" class="navigation-list-link">Instrumental Variables</a></li><li class="navigation-list-item "><a href="/Model_Estimation/interaction_terms_and_polynomials.html" class="navigation-list-link">Interaction Terms and Polynomials</a></li><li class="navigation-list-item "><a href="/Model_Estimation/linear_hypothesis_tests.html" class="navigation-list-link">Linear Hypothesis Tests</a></li><li class="navigation-list-item "><a href="/Model_Estimation/linear_mixed_effects_regression.html" class="navigation-list-link">Linear Mixed-Effects Regression</a></li><li class="navigation-list-item "><a href="/Model_Estimation/logit_model.html" class="navigation-list-link">Logit Model</a></li><li class="navigation-list-item "><a href="/Model_Estimation/mcfaddens_choice_model.html" class="navigation-list-link">McFadden's Choice Model (Alternative-Specific Conditional Logit)</a></li><li class="navigation-list-item "><a href="/Model_Estimation/ordinary_least_squares.html" class="navigation-list-link">Ordinary Least Squares (Linear Regression)</a></li><li class="navigation-list-item "><a href="/Model_Estimation/probit_model.html" class="navigation-list-link">Probit Model</a></li><li class="navigation-list-item "><a href="/Model_Estimation/regression_discontinuity_design.html" class="navigation-list-link">Regression Discontinuity Design</a></li><li class="navigation-list-item "><a href="/Model_Estimation/Nonstandard_Errors/nonstandard_errors.html" class="navigation-list-link">Nonstandard Errors</a><ul class="navigation-list-child-list"><li class="navigation-list-item ">
                            <a href="/Model_Estimation/Nonstandard_Errors/bootstrap_se.html" class="navigation-list-link">Bootstrap Standard Errors</a>
                          </li><li class="navigation-list-item ">
                            <a href="/Model_Estimation/Nonstandard_Errors/clustered_se.html" class="navigation-list-link">Cluster-Robust Standard Errors</a>
                          </li><li class="navigation-list-item ">
                            <a href="/Model_Estimation/Nonstandard_Errors/hc_se.html" class="navigation-list-link">Heteroskedasticity-consistent standard errors</a>
                          </li></ul></li></ul></li><li class="navigation-list-item"><a href="/Presentation/Presentation.html" class="navigation-list-link">Presentation</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Presentation/export_a_formatted_regression_table.html" class="navigation-list-link">Export a Formatted Regression Table</a></li><li class="navigation-list-item "><a href="/Presentation/heatmap_colored_correlation_matrix.html" class="navigation-list-link">Heatmap Colored Correlation Matrix</a></li><li class="navigation-list-item "><a href="/Presentation/line_graph_with_labels_at_the_beginning_or_end.html" class="navigation-list-link">Line Graph with Labels at the Beginning or End of Lines</a></li><li class="navigation-list-item "><a href="/Presentation/marginal_effects_plots_for_interactions_with_continuous_variables.html" class="navigation-list-link">Marginal Effects Plots for Interactions with Continuous Variables</a></li><li class="navigation-list-item "><a href="/Presentation/scatterplot_by_group_on_shared_axes.html" class="navigation-list-link">Scatterplot by Group on Shared Axes</a></li><li class="navigation-list-item "><a href="/Presentation/styling_line_graphs.html" class="navigation-list-link">Styling Line Graphs</a></li></ul></li><li class="navigation-list-item"><a href="/Summary_Statistics/Summary_Statistics.html" class="navigation-list-link">Summary Statistics</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Summary_Statistics/Balance_Tables.html" class="navigation-list-link">Balance Table</a></li><li class="navigation-list-item "><a href="/Summary_Statistics/Summary_Statistics_Tables.html" class="navigation-list-link">Summary Statistics Tables</a></li></ul></li><li class="navigation-list-item"><a href="/Time_Series/Time_Series.html" class="navigation-list-link">Time Series</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Time_Series/AR-models.html" class="navigation-list-link">Auto Regressive Models</a></li><li class="navigation-list-item "><a href="/Time_Series/creating_time_series_dataset.html" class="navigation-list-link">Creating Time Series Dataset</a></li></ul></li><li class="navigation-list-item"><a href="/Other/Other.html" class="navigation-list-link">Other</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/Other/import_a_foreign_data_file.html" class="navigation-list-link">Import a Foreign Data File</a></li></ul></li><li class="navigation-list-item"><a href="/Desired_Nonexistent_Pages/desired_nonexistent_pages.html" class="navigation-list-link">Desired Nonexistent Pages</a></li><li class="navigation-list-item"><a href="/Contributing/Contributing.html" class="navigation-list-link">Contributing</a></li></ul>
</nav>
      </div>
      <footer class="site-footer">
        <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="main-content">
        <div class="page-header js-page-header">
          <div class="search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search LOST" aria-label="Search LOST" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
            <ul class="list-style-none text-small aux-nav">
                <li class="d-inline-block my-0"><a href="https://github.com/lost-stats/lost-stats.github.io/blob/source/Geo-Spatial/geocode.md">Edit this page on GitHub</a></li>
            </ul>
        </div>
        <div class="page">
          <div id="main-content" class="page-content" role="main">
              <h1 id="geocoding">
          <a href="#geocoding" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Geocoding
      </h1>
      <h1 id="geocoding-1">
          <a href="#geocoding-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Geocoding
      </h1>
<p><strong>Geocoding</strong> is taking an address (e.g. 1600 Pennsylvania Ave NW,
Washington DC 20500) or a name of a place (e.g. The White House) and
turning it into a geographic position on the earth’s surface. Commonly,
the cooridinate system is longitude and latitude but there are other
<a href="https://pro.arcgis.com/en/pro-app/help/data/geocoding/introduction-to-finding-places-on-a-map.htm">potential coordinate
systems</a>
that can be used.</p>
<p>There are many different types of locations one can geocode including:</p>
<ol>
  <li>Cities 2. Landmarks 3. Geographic Locations * Mountains * Rivers 3.
Addresses * Street Intersections * House Numbers with street names *
Postal Codes</li>
</ol>
<p>There are multiple ways to geocode. For instance, you could find the
corrdinates of the Empire State building by flying to New York, riding
an elevator to the top of the building, and then using your GPS to get
the latitiude and longitude of where you were standing. A much more
efficient way of geocoding is through <strong>interpolation</strong>. Interpolation
uses other known geocoded locations to estimate the coordinates of the
data that you wish to geocode. A computer uses an algorithm and the
closest known geocodes to conduct this interpolation. However, the
farther the “closest” known geocodes are to the data you are trying to
geocode the less <em>accurate</em> the geocoding process is.
<a href="https://smartystreets.com/articles/what-are-geocodes">smartystreets</a>, a
geocode platform, has a good explanation of this.</p>
<p>Additionally, <strong>Reverse Geocoding</strong> takes a latitude-longitude pair (or
other global coordinates) and converts it into an address or a place.
Depending on the data that is available reverse geocoding can be very
useful. Similar to regular geocoding, reverse geocoding uses other known
reverse geocoded locations to estimate the address of the inputted
coordinates.</p>
      <h2 id="the-geocoding-process">
          <a href="#the-geocoding-process" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> The Geocoding Process
      </h2>
<p>Whenever you geocode data there is a 3 step process that is undergone:</p>
<ul>
  <li><strong>Step 1: Input Data</strong> Descriptive or textual data is inputted to
yield a desired corresponding spatial data</li>
  <li><strong>Step 2: Classification of Input Data</strong> Input data is sorted into
two groups <em>relative input data</em> and <em>absolute data</em></li>
  <li><strong>Step 3A: Relative Input Data</strong> Relative input data is the
non-preferred type of data (most geocoding reject relative input
data). Relative data are textual descriptions of locations that
cannot be converted into precise spatial data on their own. Instead
they are dependent on a other reference locations. For example,
“across the street from the White House” has to use “the White
House” as a reference point and then deduce what “across the street”
means.</li>
  <li><strong>Step 3B: Absolute Data</strong> This is the sweet sweet data that
geocoding platforms love. A spatial coordinate (lon, lat) can be
defined for this data independently of other reference points.
Examples: USPS ZIP codes; complete and partial postal addresses; PO
boxes; cities; counties; intersections; and named places</li>
</ul>
      <h2 id="why-is-geocoding-helpful">
          <a href="#why-is-geocoding-helpful" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Why is geocoding helpful?
      </h2>
<p>Odds are if you are on this page then you already have a reason to use
geocoding, but here is a brief motivation for how geocoding can help
with a project. Geocoding is helpful when you want to do spatial work.
For example, maybe you have data on voter addresses and want to
visualize party allegiance. Perhaps, you are wondering who is affected
by a certain watershed. If you are limited to postal addresses without
being able to visualize the actual location of those addresses the
inference is limited. Commuter habits, crime trends, pandemic evolution,
and (fill in your example here) analyses are all improved with
geocoding. Thanks, geocoding!</p>
      <h2 id="geocoding-services">
          <a href="#geocoding-services" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Geocoding Services
      </h2>
<p>It is important to recognize that there are many different geocoding
platforms. There are others but here is a short list of platforms to
consider:</p>
<ol>
  <li><a href="https://www.geocod.io/">Geocodio</a></li>
  <li><a href="https://developers.google.com/maps/documentation/geocoding/intro">Google’s geocode API
service</a></li>
  <li><a href="https://geomarker.ipums.org/">IPUMS Geomarker</a></li>
  <li><a href="https://geocode.arcgis.com/arcgis/">ArcGIS</a></li>
</ol>
<p>This page will talk specifically about Geocodio and how to use the
Goecodio platform in <strong>R studio</strong>. When you are deciding which geocode
platform to use some important things to keep in mind are <strong>pricing
structures</strong> and other specific features of the platfrom like <strong>bulk
geocoding</strong> and <strong>coverage</strong>. For example, Geocodio is much more suited
to geocode big data sets than Google’s platform. However, Geocodio is
only able to geocode within the United States and Cananda whereas Google
has international capabilities. Google is better at guessing what
location you are trying to geocode (“the White House”) than Geocodio,
but Geocodio offers census appends. The pricing sturcture is also
nuanced across platforms. <a href="https://www.geocod.io/compare/">Here</a> is a
comparison chart provided by Geocodio that gives a flavor of what to
consider when deciding which service to use (disclaimer, I find it to be
a bit biased…) Lots to consider! In the end, which platform works best
will depend on your preferences and the nature of your project.</p>
      <h2 id="geocodio">
          <a href="#geocodio" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Geocodio
      </h2>
<p>This page will focus specifically on using Geocodio. <a href="https://www.geocod.io/">Geocodio’s
website</a> is very straight forward, but I will
briefly walk through the porcess:</p>
<ol>
  <li>
    <p>Start by making an account. This account will allow you to do your
geocoding with Geocodio as well as get a Geocodio API which we can
use in R studio.</p>
  </li>
  <li>
    <p>To geocode on the website you can either upload a spreadsheet or
copy and paste addresses into the input window. I highly recommend a
spreadsheet which takes a <a href="https://www.geocod.io/guides/preparing-your-spreadsheet/">specific
format</a></p>
  </li>
  <li>
    <p>Geocodio will ask you to make edits if the data you have provided
isn’t accurate enough</p>
  </li>
  <li>
    <p>Once your data is in satisfactory form Geodio allows you to make
<em>appends</em> which allows you to include information pertaining to the
addresses you wish to geocode (e.g. what State Legislative District
the address is in or Census ACS Demographic information for the
addresses you are geocoding)</p>
  </li>
  <li>
    <p>Finally Geocodio will geocode your addresses and return a
downloadable csv file. The cost and the time of this process depends
on the size of your data. For example, 250,000 addresses can be
geocoded for $123.75 and will take about an hour to process. For
estimates of both cost and time click
<a href="https://www.geocod.io/pricing/">here</a></p>
  </li>
</ol>
      <h1 id="implementations">
          <a href="#implementations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Implementations
      </h1>
      <h2 id="rgeocodio-r--geocodio">
          <a href="#rgeocodio-r--geocodio" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> rgeocodio (R + Geocodio)
      </h2>
<p>rgeocodio allows you to access the Geocodio platform in R studio.
Instead of the steps mentioned above you can use the rgeocodio to
perform the same functions.</p>
<p>In order to install <code class="highlighter-rouge">rgeocodio</code> you will need to load the <code class="highlighter-rouge">devtools</code>
package. Install it if you haven’t already
<code class="highlighter-rouge">install.packages("devtools")</code>. Once <code class="highlighter-rouge">devtools</code> is loaded
run:<code class="highlighter-rouge">devtools::install_github('hrbrmstr/rgeocodio')</code>.</p>
<p>rgeocodio uses an API that you can get from the geocodio website. To get
an API visit <a href="https://www.geocod.io/features/api/">geocodio’s website</a>.
Then save it in your <strong>Renviron</strong>.</p>
<p>To save the API in your <strong>Renvrion</strong>: 1. Open the <strong>Renviron</strong> by
running <code class="highlighter-rouge">usethis::edit_r_environ()</code> 2. Once you are in the <strong>Renviron</strong>
name and save the API you got from Geocodio. Maybe something like:</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#geocodio_API = 'your api`</span><span class="w">
</span></code></pre></div></div>
<ol>
  <li>Save your <strong>Renviron</strong> and then restart your R session just to be
sure that the API is saved.</li>
</ol>
<p>Now that you have your API saved in R you still need to authorize the
API in your R session. Do so by running <code class="highlighter-rouge">gio_auth()</code>.</p>
<p>A quick note, <code class="highlighter-rouge">force</code> makes you se a new geocodio API key for the
current environment. In general you will want to run <code class="highlighter-rouge">force=F</code>. Lets try
a regeocodio example. Say you want to get the coordinates of the White
House. You could run:</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rgeocodio</span><span class="o">::</span><span class="n">gio_geocode</span><span class="p">(</span><span class="s1">'1600 Pennsylvania Ave NW, Washington DC 20500'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 2 x 16
##   formatted_addre… accuracy accuracy_type source number street suffix
##   &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
## 1 1600 Pennsylvan…      1   rooftop       City … 1600   Penns… Ave   
## 2 1600 Pennsylvan…      0.7 rooftop       City … 1600   Penns… Ave   
## # … with 9 more variables: postdirectional &lt;chr&gt;, formatted_street &lt;chr&gt;,
## #   city &lt;chr&gt;, county &lt;chr&gt;, state &lt;chr&gt;, zip &lt;chr&gt;, country &lt;chr&gt;,
## #   location_lat &lt;dbl&gt;, location_lng &lt;dbl&gt;
</code></pre></div></div>
<p>Most of these variables are intuitive but I want to spend a few seconds
on <strong>accuracy</strong> and <strong>accuracy type</strong> which we can learn more about
<a href="https://www.geocod.io/docs/#accuracy-score">here</a>.</p>
<ol>
  <li>
    <p>Accuracy: because geocodio is interpolating the output will tell you
how confident geocodio is in its estimation. Anything below 0.8
should be considered not accurate enough, but that is up to the
user.</p>
  </li>
  <li>
    <p>Accuracy Type: interpolation uses the closest know geocodes. So if
the closest geocodes are, for instance two ends of a street and you
are trying to geocode a location somewhere on that street then the
accuracy type will be “street.” In this case the accuracy type is
“rooftop” which means the buildings on either side of the location
were used to interpolate your query. Again,
<a href="https://smartystreets.com/articles/what-are-geocodes">smartystreets</a>
has a good explanation of this.</p>
  </li>
</ol>
<p>What if we want to geocode a bunch of addresses at once? To geocode
multiple addresses at once we will use <code class="highlighter-rouge">gio_batch_geocode</code>. The data
that we enter will need to be a <em>character vector of addresses</em>.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──

## ✓ ggplot2 3.2.1     ✓ purrr   0.3.3
## ✓ tibble  2.1.3     ✓ dplyr   0.8.4
## ✓ tidyr   1.0.0     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0

## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
</code></pre></div></div>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">addresses</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'Yosemite National Park, California'</span><span class="p">,</span><span class="w"> </span><span class="s1">'1600 Pennsylvania Ave NW, Washington DC 20500'</span><span class="p">,</span><span class="w"> </span><span class="s1">'2975 Kincaide St Eugene, Oregon, 97405'</span><span class="p">)</span><span class="w">

</span><span class="n">gio_batch_geocode</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 3 x 13
##   query response_results response_warnin… formatted_addre… city  state country
##   &lt;chr&gt; &lt;list&gt;           &lt;list&gt;           &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  
## 1 Yose… &lt;df[,11] [2 × 1… &lt;chr [1]&gt;        Yosemite Nation… Yose… CA    US     
## 2 1600… &lt;df[,16] [2 × 1… &lt;chr [1]&gt;        1600 Pennsylvan… Wash… DC    US     
## 3 2975… &lt;df[,15] [1 × 1… &lt;chr [1]&gt;        2975 Kincaid St… Euge… OR    US     
## # … with 6 more variables: number &lt;chr&gt;, street &lt;chr&gt;, suffix &lt;chr&gt;,
## #   postdirectional &lt;chr&gt;, formatted_street &lt;chr&gt;, zip &lt;chr&gt;
</code></pre></div></div>
<p>You will notice that the output is a list with dataframes of the results
embedded. There are a number of ways to extract the relevant data but
one approach would
be:</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">addresses</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'Yosemite National Park, California'</span><span class="p">,</span><span class="w"> </span><span class="s1">'1600 Pennsylvania Ave NW, Washington DC 20500'</span><span class="p">,</span><span class="w"> </span><span class="s1">'2975 Kincaide St Eugene, Oregon, 97405'</span><span class="p">)</span><span class="w">

</span><span class="n">extract_function</span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">addresses</span><span class="p">){</span><span class="w">

</span><span class="n">data</span><span class="o">&lt;-</span><span class="n">gio_batch_geocode</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span><span class="w">
</span><span class="n">vector</span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="w">

</span><span class="n">df_function</span><span class="o">&lt;-</span><span class="k">function</span><span class="p">(</span><span class="n">vector</span><span class="p">){</span><span class="w">
  </span><span class="n">df</span><span class="o">&lt;-</span><span class="n">data</span><span class="o">$</span><span class="n">response_results</span><span class="p">[</span><span class="n">vector</span><span class="p">]</span><span class="w">
  </span><span class="n">df</span><span class="o">&lt;-</span><span class="n">df</span><span class="o">%&gt;%</span><span class="n">as.data.frame</span><span class="p">()</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">geocode_data</span><span class="o">&lt;-</span><span class="n">do.call</span><span class="p">(</span><span class="n">bind_rows</span><span class="p">,</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span><span class="w"> </span><span class="n">df_function</span><span class="p">))</span><span class="w">
</span><span class="nf">return</span><span class="p">(</span><span class="n">geocode_data</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">extract_function</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##                                formatted_address accuracy accuracy_type
## 1               Yosemite National Park, CA 95389      1.0         place
## 2               Yosemite National Park, CA 95389      0.9         place
## 3 1600 Pennsylvania Ave NW, Washington, DC 20500      1.0       rooftop
## 4 1600 Pennsylvania Ave SE, Washington, DC 20003      0.7       rooftop
## 5              2975 Kincaid St, Eugene, OR 97405      1.0       rooftop
##                                          source address_components.city
## 1 TIGER/Line® dataset from the US Census Bureau  Yosemite National Park
## 2 TIGER/Line® dataset from the US Census Bureau  Yosemite National Park
## 3                            City of Washington              Washington
## 4                            City of Washington              Washington
## 5                                          Lane                  Eugene
##   address_components.county address_components.state address_components.zip
## 1           Mariposa County                       CA                  95389
## 2           Mariposa County                       CA                  95389
## 3      District of Columbia                       DC                  20500
## 4      District of Columbia                       DC                  20003
## 5               Lane County                       OR                  97405
##   address_components.country location.lat location.lng
## 1                         US     37.63791   -119.69465
## 2                         US     37.73687   -119.57266
## 3                         US     38.89767    -77.03655
## 4                         US     38.87921    -76.98198
## 5                         US     44.02468   -123.07878
##   address_components.number address_components.street address_components.suffix
## 1                      &lt;NA&gt;                      &lt;NA&gt;                      &lt;NA&gt;
## 2                      &lt;NA&gt;                      &lt;NA&gt;                      &lt;NA&gt;
## 3                      1600              Pennsylvania                       Ave
## 4                      1600              Pennsylvania                       Ave
## 5                      2975                   Kincaid                        St
##   address_components.postdirectional address_components.formatted_street
## 1                               &lt;NA&gt;                                &lt;NA&gt;
## 2                               &lt;NA&gt;                                &lt;NA&gt;
## 3                                 NW                 Pennsylvania Ave NW
## 4                                 SE                 Pennsylvania Ave SE
## 5                               &lt;NA&gt;                          Kincaid St
</code></pre></div></div>
<p>Reverse geocoding uses <code class="highlighter-rouge">gio_reverse</code> and <code class="highlighter-rouge">gio_batch_reverse</code>.</p>
<p>For <code class="highlighter-rouge">gio_reverse</code> you submit a longitude-latitude pair:</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gio_reverse</span><span class="p">(</span><span class="m">38.89767</span><span class="p">,</span><span class="w"> </span><span class="m">-77.03655</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 6 x 17
##   formatted_addre… accuracy accuracy_type source number street suffix
##   &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
## 1 1600 Pennsylvan…     1    rooftop       City … 1600   Penns… Ave   
## 2 700 Jackson Pl …     0.97 rooftop       City … 700    Jacks… Pl    
## 3 704 Jackson Pl …     0.97 rooftop       City … 704    Jacks… Pl    
## 4 1593 Pennsylvan…     0.97 nearest_stre… TIGER… 1593   Penns… Ave   
## 5 622 E Executive…     0.97 nearest_stre… TIGER… 622    Execu… Ave   
## 6 700 Jackson Pl …     0.97 nearest_stre… TIGER… 700    Jacks… Pl    
## # … with 10 more variables: postdirectional &lt;chr&gt;, formatted_street &lt;chr&gt;,
## #   city &lt;chr&gt;, county &lt;chr&gt;, state &lt;chr&gt;, zip &lt;chr&gt;, country &lt;chr&gt;,
## #   predirectional &lt;chr&gt;, location_lat &lt;dbl&gt;, location_lng &lt;dbl&gt;
</code></pre></div></div>
<p>For <code class="highlighter-rouge">gio_batch_reverse</code> we will submit a vector of numeric entries
ordered by c(longitude, latitude):</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make a dataset </span><span class="w">
</span><span class="n">data</span><span class="o">&lt;-</span><span class="n">data.frame</span><span class="p">(</span><span class="w">
  </span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">35.9746000</span><span class="p">,</span><span class="w"> </span><span class="m">32.8793700</span><span class="p">,</span><span class="w"> </span><span class="m">33.8337100</span><span class="p">,</span><span class="w"> </span><span class="m">35.4171240</span><span class="p">),</span><span class="w">
  </span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-77.9658000</span><span class="p">,</span><span class="w"> </span><span class="m">-96.6303900</span><span class="p">,</span><span class="w"> </span><span class="m">-117.8362320</span><span class="p">,</span><span class="w"> </span><span class="m">-80.6784760</span><span class="p">)</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">gio_batch_reverse</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 29 x 17
##    formatted_addre… accuracy accuracy_type source number predirectional street
##    &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt; 
##  1 101 W Washingto…     1    rooftop       NC Ge… 101    W              Washi…
##  2 101 US Hwy 64 A…     1    nearest_stre… TIGER… 101    &lt;NA&gt;           US Hw…
##  3 126 US Hwy 64 A…     1    nearest_stre… TIGER… 126    &lt;NA&gt;           US Hw…
##  4 101 E Washingto…     0.99 rooftop       Nash   101    E              Washi…
##  5 101 W Washingto…     0.99 rooftop       Nash   101    W              Washi…
##  6 100 E Washingto…     0.99 rooftop       NC Ge… 100    E              Washi…
##  7 101 E Washingto…     0.99 rooftop       NC Ge… 101    E              Washi…
##  8 100 N Alston St…     0.99 nearest_stre… TIGER… 100    N              Alston
##  9 3034 S 1st St, …     1    rooftop       City … 3034   S              1st   
## 10 3034 S 1st St, …     0.99 rooftop       Dallas 3034   S              1st   
## # … with 19 more rows, and 10 more variables: suffix &lt;chr&gt;,
## #   formatted_street &lt;chr&gt;, city &lt;chr&gt;, county &lt;chr&gt;, state &lt;chr&gt;, zip &lt;chr&gt;,
## #   country &lt;chr&gt;, location_lat &lt;dbl&gt;, location_lng &lt;dbl&gt;,
## #   postdirectional &lt;chr&gt;
</code></pre></div></div>
<p>Notice that the output gives us multiple accuracy types.</p>
<p>What about geocoding the rest of the world,
chico?</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rgeocodio</span><span class="o">::</span><span class="n">gio_batch_geocode</span><span class="p">(</span><span class="s1">'523-303, 350 Mokdongdong-ro, Yangcheon-Gu, Seoul, South Korea 07987'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 1 x 8
##   query response_results response_warnin… formatted_addre… city  state zip  
##   &lt;chr&gt; &lt;list&gt;           &lt;list&gt;           &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 523-… &lt;list [0]&gt;       &lt;chr [1]&gt;        Korea, GU 07987  Korea GU    07987
## # … with 1 more variable: country &lt;chr&gt;
</code></pre></div></div>
<p><em>gasp</em> Geocodio only works, from my understanding, in the United States
and Canada. We would need to use a different service like <strong>Google’s
geocoder</strong> to do the rest of the world.</p>
      <h2 id="keep-in-mind">
          <a href="#keep-in-mind" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Keep in Mind
      </h2>
<ul>
  <li>Be attentive to <strong>accruacy</strong> and <strong>accuracy type</strong>. Just because
something is spit out doesn’t mean you should use/trust it</li>
  <li>When you run rgeocodio commands in R it accessing Geocodio’s server
so you need to consider pricing (2,500 free lookups per day)</li>
  <li>One size doesn’t necesarily fit all–tailor the geocode platform you
choose to your project</li>
</ul>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
