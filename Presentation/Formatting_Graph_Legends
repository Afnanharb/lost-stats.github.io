---
title: "Formatting Graph Legends"
parent: "Presentation"
mathjax: true
---

## Formatting Graph Legends

Graph legends are an important part of data representation, as they enable the reader to better under stand the figure infront of them while not cluttering the figure itself. Legends can often be seen next to graphs describing some of aspect of a graph.
For more information on graphs see other articles such as: bar graphs, scatter plots and histograms.

# GRaphs legends in R

Here are some of the packages that will be used in this section:
```{r}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, broom, knitr, ggplot2)
```

The dataset used in this article will be the ***mtcars*** dataset as it comes with base R. The functions here is the ggplot and geom_pointfrom the ***ggplot2*** package. Geom_point creates a scatter plot while  in ggplot we will efin the axis and the legend. More Specifically in aes() we color the point depending on the number of cylinders.

```{r}
fig1 <- ggplot(mtcars, aes(wt, mpg, colour = factor(cyl))) +
       geom_point()
fig1
```

Now we can add another layor by giving each type of transition a different shape through shape in aes(). Additionally, you can augment the labels for both colour and shape with labs().

```{r}
fig2 <- ggplot(mtcars, aes(wt, mpg, colour = factor(cyl), shape = factor(am) )) +
  geom_point()
  
fig2 + labs(colour= "Number of Cylinders", shape = "Transmission Type")

```

To change the legend position use the themes() modifier in ggplot. From there you can choose top, right, bottom, left, or none (removes the legend). To put the legends inside the plot create column vector of size 2 (the first value refers to the x coord. while the second refers to the y) where both elements are between 0 and 1. To ensure that the whole legends is within the graph use the legend.justification to set the corner where you want the legend.

```{r}
fig2 + 
    theme(
    legend.position = c(.95, .95),
    legend.justification = c("right", "top")
    )
  
```

There are other cool things you can do to the legend to better customize the visual experience by adding more to the ***theme*** modifier such as:
* Changing the margin size with ***legend.box.margin***
* The color of the box around the legend with ***legend.box.background***
* Changing the font size and color with ***legend.text***
* Changing the boxes of the legend key with ***legend.key***
```{r}
fig3 <- fig2 +
  theme(
    legend.box.background = element_rect(color="red", size=2),
    legend.box.margin = margin(116, 6, 6, 6),
    legend.key = element_rect(fill = "white", colour = "black"),
    legend.text = element_text(size = 8, colour = "red")
  )
fig3
```

# Legend Formatting in Stata

In stata the legend is automatically added when you create a graph with multiple lines. However there may be instances where you would still prefer to have a legend on a single line graph or possibly no legend on your graph in general. For those times just add legend(on) or legend(off). 

```{}
line le year, legend(on)
```
![Automatic Legend](lost-stats.github.io/Presentation/Formatting_Graph_Legends/Formatting_Legends_image/form_graph1.png)

Labelling legends is also straight forward, within the legend function add label(n "line title") to augment the titles, where 'n' is the nth group.

```{}
line le_m le_f year, legend(label(1 "Males") label(2 "Females"))

```
![Now With Labels](lost-stats.github.io/Presentation/Images/Formatting_Legends_image/form_graph2.png)

Legend position can be changed with the position(), col(), and ring() modifiers in the legend() funciton. Here position refer to where the legend is placed with respect to the center of the graph using clock directions (i.e. 6 is 6 o'clock or below and 3 is 3 o'clock or right). col() is the number of columns the legend will take up, usually you just want to set the to be 1 to prevent the graph and legend fighting over space. ring() refers to the distance away from the center of the graph.

```{}
line le_m le_f year, legend(pos(3) col(1)) lab(1 "Males") lab(2 "Females") stack)

```
![Changing the Legend Position](lost-stats.github.io/Presentation/Images/Formatting_Legends_image/form_graph3.png)

Then you can add some color to the legend with region() and a title with subtitle():

```{}
line le_m le_f year, legend(pos(5) ring(0) col(1)
lab(1 "Males") lab(2 "Females")
region(fcolor(gs15)))
legend(subtitle("Legend"))
```
![Final Product](lost-stats.github.io/Presentation/Images/Formatting_Legends_image/form_graph1.png)
